{"kind":"Notebook","sha256":"e2b725f7c79099ffc6bdca6c33361a601b595f16c273a6a15a3e9be1914d22c9","slug":"chatbot-explained","location":"/exercise3/chatbot_explained.ipynb","dependencies":[],"frontmatter":{"title":"Programming your own chatbot","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Robert Haase","given":"Robert","family":"Haase"},"name":"Robert Haase","orcid":"0000-0001-5949-2327","github":"haesleinhuepf","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Ronny Gey","given":"Ronny","family":"Gey"},"name":"Ronny Gey","orcid":"0000-0003-1028-1670","affiliations":["ufz"],"github":"geyslein","id":"contributors-myst-generated-uid-1"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/ScaDS/ai_training_ufz_2025","keywords":["AI","OER"],"copyright":"Copyright: Ronny Gey, UFZ Leipzig, Robert Haase, ScaDS.AI Leipzig, licensed <a href=\"https://creativecommons.org/licenses/by/4.0/\" target=\"_blank\">CC-BY 4.0</a> unless mentioned otherwise. Contributions and feedback are welcome.","affiliations":[{"id":"ufz","name":"Helmholtz Center for Environmental Research - UFZ","ror":"000h6jb29"}],"exports":[{"format":"ipynb","filename":"chatbot_explained.ipynb","url":"/chatbot_explained-af9f9b50d1431977932accfcca72f3e5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook we will program a basic chatbot. We can use multiple large language models, via the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZgNZcIxGF4"},{"type":"link","url":"https://github.com/openai/openai-python","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"OpenAI Python interface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yoOrLo5kU7"}],"urlSource":"https://github.com/openai/openai-python","error":true,"key":"svz9hVBotD"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"haBfJsRIGZ"}],"key":"gTZBQmCnZU"}],"key":"QVVQ0z5P3h"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from llm_utilities import prompt_chatgpt, prompt_ollama, prompt_blablador, prompt_claude","visibility":"show","key":"dJcmQBMlo4"},{"type":"output","id":"uPASHzrobkAgLmRjOJuBO","data":[],"visibility":"show","key":"FW985c9TEK"}],"visibility":"show","key":"HzzPr2AkdS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Decide for a prompt function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ivbpm8b0Iy"}],"identifier":"decide-for-a-prompt-function","label":"Decide for a prompt function","html_id":"decide-for-a-prompt-function","implicit":true,"key":"mU07EyZDuc"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here we need to decide for one of the prompt-functions introduced before.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"v6hSNKscOg"}],"key":"XN4qDXpRax"}],"key":"cKYGZMDhy3"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt = prompt_blablador","visibility":"show","key":"OxASZt1fTZ"},{"type":"output","id":"d53Q_dRS4IpLJQFKQaiZA","data":[],"visibility":"show","key":"SJHyKaoa1a"}],"visibility":"show","key":"bZPXwIjtDw"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt(\"Hi!\")","visibility":"show","key":"t7v4wHvMaP"},{"type":"output","id":"fYSaUhATM-mBvAajlTtU0","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"'Hello! How can I help you today?'","content_type":"text/plain"}}}],"visibility":"show","key":"TBjJAIJtgZ"}],"visibility":"show","key":"UiJe901ysm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adding memory","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nubiNy0wbE"}],"identifier":"adding-memory","label":"Adding memory","html_id":"adding-memory","implicit":true,"key":"WiC3Qf8mRq"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Our prompt function does not have memory yet.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WbnjaBlKaJ"}],"key":"LdzbMwin7Y"}],"key":"H3YQ1jhAsV"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt(\"Hi, my name is Robert.\")","visibility":"show","key":"uunyMjePBr"},{"type":"output","id":"9E15qO4MXlYJkc9ZgZR4w","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"'Nice to meet you, Robert! How are you doing today? Is there something I can help you with or would you like to chat?'","content_type":"text/plain"}}}],"visibility":"show","key":"o1I4DSRnDk"}],"visibility":"show","key":"iiRW1N8zU8"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt(\"What is my name?\")","visibility":"show","key":"pBVjB1oHCr"},{"type":"output","id":"NFesX0z9Am-e-XLpdzDz8","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"\"I'm a large language model, I don't have any information about your personal identity, including your name. Our conversation just started, and I don't retain any information about individual users. If you'd like to share your name with me, I'd be happy to chat with you and learn more about you!\"","content_type":"text/plain"}}}],"visibility":"show","key":"vq24VB0nGR"}],"visibility":"show","key":"sbcF5yRbQ1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Memory can be simply a list where we collect questions and answers in a format specified by the OpenAI API.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oAOFBIngJy"}],"key":"Kbszr8rezW"}],"key":"O48hFjmdf3"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"chat_history = []\ndef prompt_with_memory(message:str):\n    \n    # convert message in the right format and store it in memory\n    question = {\"role\": \"user\", \"content\": message}\n    chat_history.append(question)\n    \n    # receive answer\n    response = prompt(chat_history)\n    \n    # convert answer in the right format and store it in memory\n    answer = {\"role\": \"assistant\", \"content\": message}\n    chat_history.append(answer)\n    \n    return response","visibility":"show","key":"H7UXFdtq3X"},{"type":"output","id":"IZwh0qZCMgSYzZzv95vrB","data":[],"visibility":"show","key":"WsSIL61Ski"}],"visibility":"show","key":"OYoAYuarbC"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt_with_memory(\"Hi, my name is Robert.\")","visibility":"show","key":"FPz53EzJiW"},{"type":"output","id":"-zTiaKXK7Osh-4WUi0aq-","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"'Hello Robert! Nice to meet you! Is there something I can help you with or would you like to chat?'","content_type":"text/plain"}}}],"visibility":"show","key":"DkeudSa2Ua"}],"visibility":"show","key":"NPUS2Wg5C8"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"prompt_with_memory(\"What is my name?\")","visibility":"show","key":"FfFQmmaJD0"},{"type":"output","id":"Hcu6ge0b8QxSIwlax3oOY","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"'Your name is Robert!'","content_type":"text/plain"}}}],"visibility":"show","key":"kMX6KKfCRa"}],"visibility":"show","key":"og1HeJpU92"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Continuous discussion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8lf7h4YRk"}],"identifier":"continuous-discussion","label":"Continuous discussion","html_id":"continuous-discussion","implicit":true,"key":"PlgSxDIZQE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Finally, we use the functions above for a continuous chat.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dThUwA4LGF"}],"key":"WcpxjC0wqb"}],"key":"gnROVYcJND"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"question = \"\"\nwhile(question != \"bye\"):\n    question = input(\"Q:\")\n    \n    answer = prompt_with_memory(question)\n    print(\"A:\",answer)","visibility":"show","key":"jwJfmcw1LI"},{"type":"output","id":"cnZ7nmumCL0Rv0IEB3ULX","data":[],"visibility":"show","key":"cVQ52nJTBh"}],"visibility":"show","key":"YFMC56tGbN"}],"key":"wnJkEMKH9O"},"references":{"cite":{"order":[],"data":{}}}}